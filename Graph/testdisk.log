

Wed Dec 18 00:56:11 2019
Command line: TestDisk

TestDisk 7.0, Data Recovery Utility, April 2015
Christophe GRENIER <grenier@cgsecurity.org>
http://www.cgsecurity.org
OS: Linux, kernel 5.0.0-37-generic (#40~18.04.1-Ubuntu SMP Thu Nov 14 12:06:39 UTC 2019) x86_64
Compiler: GCC 7.2
ext2fs lib: 1.44.1, ntfs lib: libntfs-3g, reiserfs lib: none, ewf lib: none, curses lib: ncurses 6.0
User is not root!
Hard disk list


TestDisk exited normally.


Wed Dec 18 00:56:19 2019
Command line: TestDisk

TestDisk 7.0, Data Recovery Utility, April 2015
Christophe GRENIER <grenier@cgsecurity.org>
http://www.cgsecurity.org
OS: Linux, kernel 5.0.0-37-generic (#40~18.04.1-Ubuntu SMP Thu Nov 14 12:06:39 UTC 2019) x86_64
Compiler: GCC 7.2
ext2fs lib: 1.44.1, ntfs lib: libntfs-3g, reiserfs lib: none, ewf lib: none, curses lib: ncurses 6.0
/dev/sda: LBA, HPA, LBA48, DCO support
/dev/sda: size       976773168 sectors
/dev/sda: user_max   976773168 sectors
/dev/sda: native_max 976773168 sectors
/dev/sda: dco        976773168 sectors
Warning: can't get size for Disk /dev/mapper/control - 0 B - 0 sectors, sector size=512
Hard disk list
Disk /dev/sda - 500 GB / 465 GiB - CHS 60801 255 63, sector size=512 - Samsung SSD 860 EVO 500GB, S/N:S3Z2NB0KC05593T, FW:RVT02B6Q

Partition table type (auto): EFI GPT
Disk /dev/sda - 500 GB / 465 GiB - Samsung SSD 860 EVO 500GB
Partition table type: EFI GPT

Analyse Disk /dev/sda - 500 GB / 465 GiB - CHS 60801 255 63
hdr_size=92
hdr_lba_self=1
hdr_lba_alt=976773167 (expected 976773167)
hdr_lba_start=34
hdr_lba_end=976773134
hdr_lba_table=2
hdr_entries=128
hdr_entsz=128
check_part_gpt failed for partition
 3 P MS Reserved              1228800    1261567      32768 [Microsoft reserved partition]
Current partition structure:
 1 P Unknown                     2048    1023999    1021952 [Basic data partition]
 2 P EFI System               1024000    1228799     204800 [EFI system partition]
No FAT, NTFS, ext2, JFS, Reiser, cramfs or XFS marker
 3 P MS Reserved              1228800    1261567      32768 [Microsoft reserved partition]
 3 P MS Reserved              1228800    1261567      32768 [Microsoft reserved partition]
 4 P MS Data                  1261568  577988607  576727040 [Basic data partition]
 5 P Unknown                577988608  579160482    1171875
 6 P Unknown                579162112  685895679  106733568
 7 P Unknown                685895680  963239935  277344256
 8 P Linux Swap             963239936  976771071   13531136

search_part()
Disk /dev/sda - 500 GB / 465 GiB - CHS 60801 255 63
NTFS at 0/32/33
filesystem size           1021952
sectors_per_cluster       8
mft_lcn                   42581
mftmirr_lcn               2
clusters_per_mft_record   -10
clusters_per_index_record 1
NTFS part_offset=1048576, part_size=523239424, sector_size=512
NTFS partition cannot be added (part_offset<part_size).
NTFS at 0/32/33
filesystem size           1021952
sectors_per_cluster       8
mft_lcn                   42581
mftmirr_lcn               2
clusters_per_mft_record   -10
clusters_per_index_record 1
     MS Data                     2048    1023999    1021952
     NTFS, blocksize=4096, 523 MB / 499 MiB
FAT32 at 63/188/62
FAT1 : 6654-7422
FAT2 : 7423-8191
start_rootdir : 8192 root cluster : 2
Data : 8192-204799
sectors : 204800
cluster_size : 2
no_of_cluster : 98304 (2 - 98305)
fat_length 769 calculated 769
set_FAT_info: name from BS used

FAT32 at 63/188/62
     MS Data                  1024000    1228799     204800 [NO NAME]
     FAT32, blocksize=1024, 104 MB / 100 MiB
NTFS at 78/102/25
filesystem size           975513600
sectors_per_cluster       8
mft_lcn                   786432
mftmirr_lcn               2
clusters_per_mft_record   -10
clusters_per_index_record 1
NTFS part_offset=644874240, part_size=499462963200, sector_size=512
NTFS partition cannot be added (part_offset<part_size).
NTFS at 78/102/25
filesystem size           975513600
sectors_per_cluster       8
mft_lcn                   786432
mftmirr_lcn               2
clusters_per_mft_record   -10
clusters_per_index_record 1
     MS Data                  1259520  976773119  975513600
     NTFS, blocksize=4096, 499 GB / 465 GiB

Results
   P MS Data                     2048    1023999    1021952
     NTFS, blocksize=4096, 523 MB / 499 MiB
   P MS Data                  1024000    1228799     204800 [NO NAME]
     FAT32, blocksize=1024, 104 MB / 100 MiB
   P MS Data                  1259520  976773119  975513600
     NTFS, blocksize=4096, 499 GB / 465 GiB

Hint for advanced users. dmsetup may be used if you prefer to avoid to rewrite the partition table for the moment:
echo "0 1021952 linear /dev/sda 2048" | dmsetup create test0
echo "0 204800 linear /dev/sda 1024000" | dmsetup create test1
echo "0 975513600 linear /dev/sda 1259520" | dmsetup create test2

interface_write()
 1 P MS Data                     2048    1023999    1021952
 2 P MS Data                  1024000    1228799     204800 [NO NAME]
 3 P MS Data                  1259520  976773119  975513600
simulate write!
Partition table type (auto): EFI GPT
Disk /dev/sda - 500 GB / 465 GiB - Samsung SSD 860 EVO 500GB
Partition table type: EFI GPT

Interface Advanced
hdr_size=92
hdr_lba_self=1
hdr_lba_alt=976773167 (expected 976773167)
hdr_lba_start=34
hdr_lba_end=976773134
hdr_lba_table=2
hdr_entries=128
hdr_entsz=128
check_part_gpt failed for partition
 3 P MS Reserved              1228800    1261567      32768 [Microsoft reserved partition]
 1 P Unknown                     2048    1023999    1021952 [Basic data partition]
 2 P EFI System               1024000    1228799     204800 [EFI system partition]
 3 P MS Reserved              1228800    1261567      32768 [Microsoft reserved partition]
 4 P MS Data                  1261568  577988607  576727040 [Basic data partition]
     NTFS, blocksize=4096, 295 GB / 275 GiB
 5 P Unknown                577988608  579160482    1171875
 6 P Unknown                579162112  685895679  106733568
 7 P Unknown                685895680  963239935  277344256
 8 P Linux Swap             963239936  976771071   13531136

TestDisk exited normally.
